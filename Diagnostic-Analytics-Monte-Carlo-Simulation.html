
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Diagnostic Analytics: Monte Carlo Simulation &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Diagnostic-Analytics-Monte-Carlo-Simulation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to Monte Carlo Simulation for Estimating Area Inside Rose Petals" href="Rose_Curve.html" />
    <link rel="prev" title="Data Reshaping with Pandas" href="Data-Reshaping-with-Pandas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Data Manipulation with Pandas
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduction-To-Pandas.html">Introduction to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Reading-Data-Using-Pandas.html">Reading Data using Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Basic-Attributes-and-Methods.html">Basic Attributes and Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-1.html">Exercise 1: Basic Attributes and Methods using gapminder</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions-Exercise-1.html">Solutions for Exercise 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Row-and-Column-Selection.html">Slicing and Selecting in DataFrames in Pandas”</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-2.html">Exercise 2: Slicing and Selecting in DataFrames in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating-or-Removing-Columns-from-DataFrame.html">Creating or Removing Columns from DataFrame</a></li>
<li class="toctree-l1"><a class="reference internal" href="Exercise-3.html">Exercise 3: Creating or Removing Columns from DataFrame in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Data-Reshaping-with-Pandas.html">Data Reshaping with Pandas</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><span style="color: dimgray;"><strong>Diagnostic Analytics: Monte Carlo Simulation</strong></span></a></li>
<li class="toctree-l1"><a class="reference internal" href="Rose_Curve.html">Introduction to Monte Carlo Simulation for Estimating Area Inside Rose Petals</a></li>

<li class="toctree-l1"><a class="reference internal" href="SRW.html">Simple Random Walk Definition</a></li>


<li class="toctree-l1"><a class="reference internal" href="Exercise-Diagnostic-Analytics-Monte-Carlo-Simulation.html">Exercise: Diagnostic Analytics, Monte Carlo Simulation and sampling methods</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FDiagnostic-Analytics-Monte-Carlo-Simulation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Diagnostic-Analytics-Monte-Carlo-Simulation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><span style="color: dimgray;">Diagnostic Analytics: Monte Carlo Simulation</span></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-actuarial-data-collection"><span style="color: dimgray;"><strong>Exploring Actuarial Data Collection</strong></span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strategies-for-collecting-data"><span style="color: dimgray;"><strong>Strategies for Collecting Data</strong></span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-probability-methods"><span style="color: dimgray;"><strong>Non-Probability Methods</strong></span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-methods"><span style="color: dimgray;"><strong>Probability Methods</strong></span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerations-in-data-collection"><span style="color: dimgray;"><strong>Considerations in Data Collection</strong></span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-methods">Monte Carlo methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connection-to-sampling-methods">Connection to Sampling Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-simulation-for-drawing-samples-from-a-standard-normal-distribution">Monte Carlo Simulation for Drawing Samples from a Standard Normal Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-monte-carlo-methods-an-example">Using Monte Carlo Methods: An Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-explanation">Problem Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-code">Python Code</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-methods-in-python"><span style="color: dimgray;"><strong>Sampling Methods in Python</strong></span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sampling-in-python"><span style="color: dimgray;"><strong>Simple Random Sampling in Python</strong></span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-s-random-choice">NumPy’s <code class="docutils literal notranslate"><span class="pre">random.choice()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-sample-for-sampling-without-replacement">Pandas <code class="docutils literal notranslate"><span class="pre">.sample()</span></code> for Sampling Without Replacement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-generate-a-large-population">Step 1: Generate a large population</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-draw-a-sample-using-simple-random-sampling">Step 2: Draw a sample using simple random sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compare-histograms-of-population-and-sample">Step 3: Compare histograms of population and sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-perform-basic-statistical-checks">Step 4: Perform basic statistical checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-optionally-conduct-a-t-test">Step 5: Optionally, conduct a t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-t-test-results">Interpretation of t-test results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary"><strong>Summary</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratified-sampling-in-r"><span style="color: dimgray;"><strong>Stratified Sampling in R</strong></span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#balanced-and-imbalanced-dataset"><span style="color: dimgray;"><strong>Balanced and Imbalanced Dataset</strong></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sampling-srs-in-python">Simple Random Sampling (SRS) in Python:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratified-sampling-in-python">Stratified Sampling in Python:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-1-simple-random-sampling-from-a-dataset"><strong>Answer to Question 1: Simple Random Sampling from a Dataset</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-2-evaluation-of-simple-random-sampling-srs"><strong>Answer to Question 2: Evaluation of Simple Random Sampling (SRS)</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="diagnostic-analytics-monte-carlo-simulation">
<h1><span style="color: dimgray;"><strong>Diagnostic Analytics: Monte Carlo Simulation</strong></span><a class="headerlink" href="#diagnostic-analytics-monte-carlo-simulation" title="Link to this heading">#</a></h1>
<p><strong>Diagnostic Analytics</strong> delves into understanding the reasons behind events. It employs techniques such as <strong>Monte Carlo Simulation</strong> to uncover patterns and correlations within historical data.</p>
<p>In actuarial science, the foundational processes of <strong>data collection</strong> and <strong>descriptive statistics</strong> play a pivotal role in comprehending and quantifying risk. Accurate and comprehensive data form the cornerstone for reliable actuarial analyses, offering crucial insights into the patterns and characteristics of events under scrutiny. This robust data foundation not only enables the identification of historical trends but also supports the predictive capabilities required in Monte Carlo Simulations.</p>
<p>By utilizing <strong>Monte Carlo Simulation</strong>, actuaries can simulate numerous possible scenarios based on probabilistic models derived from historical data. These simulations help in quantifying the uncertainty inherent in risk assessments, thereby enhancing decision-making processes. Through this methodological approach, actuarial professionals can not only understand the past but also anticipate and prepare for potential future outcomes with greater precision.</p>
<div class="admonition-integrated-analytical-techniques-in-actuarial-science-from-diagnostic-analytics-to-monte-carlo-methods admonition">
<p class="admonition-title">Integrated Analytical Techniques in Actuarial Science: From Diagnostic Analytics to Monte Carlo Methods</p>
<p><strong>Diagnostic Analytics</strong> focuses on understanding why something happened. It uses techniques like Monte Carlo Simulation to identify patterns and correlations in historical data.</p>
<p><strong>Descriptive statistics</strong>, in turn, facilitate the concise summarization and interpretation of this data, serving as a crucial step in the actuarial decision-making process by enabling professionals to derive meaningful conclusions and assess potential financial implications.</p>
<p><strong>Sampling Methods</strong> address this challenge by systematically selecting a subset of data points from a larger population, ensuring that insights drawn from the sample are representative and applicable to the entire population. This methodological approach bridges the gap between limited data availability and the need for robust statistical inference.</p>
<p>Furthermore, <strong>Monte Carlo Methods</strong> enhance the actuarial toolkit by simulating thousands or even millions of possible outcomes based on probabilistic models. These simulations use random sampling techniques to quantify the uncertainty and variability inherent in actuarial forecasts. By generating a diverse array of scenarios, Monte Carlo Methods empower actuaries to assess risk with greater precision and develop strategies that account for a spectrum of potential outcomes.</p>
</div>
<p>Basic terms in statistics are illustrated in the following example.</p>
<div class="admonition-example-1 admonition">
<p class="admonition-title"><strong>Example 1</strong></p>
<p>An actuarial student is interested in exploring the average income of policyholders in an actuarial portfolio. Applying the concepts in the context of actuarial science:</p>
<ol class="arabic simple">
<li><p><strong>Population:</strong> The entire collection of incomes earned by all policyholders in the actuarial portfolio.</p></li>
<li><p><strong>Sample:</strong> A subset of the population, such as the incomes of policyholders within a specific demographic or policy category.</p></li>
<li><p><strong>Variable:</strong> The “income” assigned to each individual policyholder.</p></li>
<li><p><strong>Data Value:</strong> For instance, the income of a specific policyholder, like Ms. Johnson’s income at $60,000.</p></li>
<li><p><strong>Data:</strong> The set of values corresponding to the obtained sample (e.g., $60,000; $45,000; $75,000; …).</p></li>
<li><p><strong>Experiment:</strong> The methods employed to select policyholders for the sample and determine the income of each, which could involve analyzing demographic data or using actuarial models.</p></li>
<li><p><strong>Parameter:</strong> The sought-after information concerns the “average” income of all policyholders in the entire portfolio.</p></li>
<li><p><strong>Statistic:</strong> The determined “average” income of policyholders within the selected sample.</p></li>
</ol>
</div>
<section id="exploring-actuarial-data-collection">
<h2><span style="color: dimgray;"><strong>Exploring Actuarial Data Collection</strong></span><a class="headerlink" href="#exploring-actuarial-data-collection" title="Link to this heading">#</a></h2>
<p>In the field of actuarial science, various methods are commonly employed for data collection:</p>
<ol class="arabic simple">
<li><p><strong>Actuarial Interviews</strong>
Individuals often provide responses when interviewed by an actuarial professional, but their answers may be influenced by the interviewer’s approach, for e.g., an actuarial interview aiming to assess individuals’ perception of insurance risk.</p></li>
<li><p><strong>Phone Surveys</strong>
A cost-effective method, but it is essential to keep surveys brief as respondents in actuarial contexts may have limited patience.</p></li>
<li><p><strong>Self-Administered Actuarial Questionnaires</strong>
An economical option, yet the response rate may be lower, and the participants might constitute a biased sample in actuarial analyses.</p></li>
<li><p><strong>Direct Risk Observation</strong>
For specific risk factors, an actuary may directly observe and measure quantities of interest within the sample.</p></li>
<li><p><strong>Web-Based Risk Surveys</strong>
This method is limited to the population using the web, catering to a specific subset of individuals in actuarial investigations.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>it is imperative to employ sampling methods for data collection that ensure the obtained data accurately represents the population and is free from <strong>bias</strong>.</p>
</div>
</section>
<section id="strategies-for-collecting-data">
<h2><span style="color: dimgray;"><strong>Strategies for Collecting Data</strong></span><a class="headerlink" href="#strategies-for-collecting-data" title="Link to this heading">#</a></h2>
<p>Data collection is a crucial step in the research process, and the selection of observations or measurements for a study depends on the research question and the goals of the study. There are two broad categories of methods for collecting data: <strong>non-probability methods</strong> and <strong>probability methods</strong>.</p>
<section id="non-probability-methods">
<h3><span style="color: dimgray;"><strong>Non-Probability Methods</strong></span><a class="headerlink" href="#non-probability-methods" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Convenience or Haphazard Sampling:</strong>
In convenience or haphazard sampling, units are chosen without a planned method, assuming population homogeneity. For instance, a vox pop survey randomly selects individuals passing by, introducing <strong>biases</strong> based on the interviewer’s decisions and the characteristics of those present during sampling.</p></li>
</ol>
<figure class="align-default" id="figure-convenience-sampling">
<img alt="_images/convenience-sampling.png" src="_images/convenience-sampling.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Convenience Sampling</span><a class="headerlink" href="#figure-convenience-sampling" title="Link to this image">#</a></p>
<div class="legend">
<p>Image from <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/convenience-sampling-.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/convenience-sampling-.png</a></p>
</div>
</figcaption>
</figure>
<div class="admonition-example-2 admonition">
<p class="admonition-title"><strong>Example 2</strong></p>
<p>Imagine estimating life expectancy by randomly selecting individuals waiting in line at an insurance office for an actuarial study; however, this may introduce biases if those in line have specific characteristics.</p>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Volunteer Sampling:</strong>
Volunteer sampling involves including only willing participants, often with specific criteria. For example, in a radio show discussion, only those with strong opinions may respond, causing <strong>a selection bias</strong> as the silent majority typically does not participate.</p></li>
</ol>
<div class="admonition-example-3 admonition">
<p class="admonition-title"><strong>Example 3</strong></p>
<p>Understanding financial behaviors within an insurance portfolio may involve volunteer sampling by inviting policyholders to participate; however, biases may occur if those who volunteer have unique characteristics not representative of the entire group.</p>
</div>
</section>
<section id="probability-methods">
<h3><span style="color: dimgray;"><strong>Probability Methods</strong></span><a class="headerlink" href="#probability-methods" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Simple Random Sample:</strong>
Simple random sampling involves selecting units from a population in a completely random manner, ensuring every unit has an equal chance of being chosen. For example, drawing names from a hat for a survey is a simple random sampling method, minimizing biases and providing a representative sample.</p></li>
</ol>
<figure class="align-default" id="figure-simple-random-sample">
<img alt="_images/simple-random-sample.png" src="_images/simple-random-sample.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Simple Random Sampling</span><a class="headerlink" href="#figure-simple-random-sample" title="Link to this image">#</a></p>
<div class="legend">
<p>Image from <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/simple-random-sample.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/simple-random-sample.png</a></p>
</div>
</figcaption>
</figure>
<div class="admonition-example-4 admonition">
<p class="admonition-title"><strong>Example 4</strong></p>
<p>Estimating the average lifespan of policyholders by randomly selecting a subset for study through the use of randomly generated numbers is an application of simple random sampling, ensuring unbiased representation.</p>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Stratified Random Sampling:</strong>
Stratified random sampling involves dividing the population into subgroups (strata) based on certain characteristics and then randomly selecting samples from each stratum. For instance, when studying a diverse population, dividing it into age groups and then randomly selecting individuals from each group ensures representation across different age ranges, providing more accurate insights.</p></li>
</ol>
<figure class="align-default" id="figure-stratified-sample">
<img alt="_images/stratified-sample.png" src="_images/stratified-sample.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Stratified Sampling</span><a class="headerlink" href="#figure-stratified-sample" title="Link to this image">#</a></p>
<div class="legend">
<p>Image from <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/stratified-sample.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/stratified-sample.png</a></p>
</div>
</figcaption>
</figure>
<div class="admonition-example-5 admonition">
<p class="admonition-title"><strong>Example 5</strong></p>
<p>Estimating insurance claims across various demographic groups could involve stratified random sampling by categorizing policyholders based on income levels and then selecting samples from each stratum, ensuring a more subtle understanding of claim patterns.</p>
</div>
<ol class="arabic simple" start="3">
<li><p><strong>Cluster Sampling:</strong>
Cluster sampling involves dividing the population into clusters and randomly selecting entire clusters for inclusion in the sample. For example, when studying a large geographical area, dividing it into clusters (such as cities or neighborhoods) and randomly selecting some clusters for analysis can be more practical than trying to include every individual unit, saving time and resources.</p></li>
</ol>
<figure class="align-default" id="figure-cluster-sample">
<img alt="_images/cluster-sampling.png" src="_images/cluster-sampling.png" />
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Cluster Sampling</span><a class="headerlink" href="#figure-cluster-sample" title="Link to this image">#</a></p>
<div class="legend">
<p>Image from <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/cluster-sampling.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/cluster-sampling.png</a></p>
</div>
</figcaption>
</figure>
<div class="admonition-example-6 admonition">
<p class="admonition-title"><strong>Example 6</strong></p>
<p>Assessing the risk profile of policyholders in various regions might involve cluster sampling by randomly selecting specific cities or towns as clusters and then studying all policyholders within those selected areas, providing insights into regional risk patterns.</p>
</div>
</section>
</section>
<section id="considerations-in-data-collection">
<h2><span style="color: dimgray;"><strong>Considerations in Data Collection</strong></span><a class="headerlink" href="#considerations-in-data-collection" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Sampling Frame:</strong></p>
<ul class="simple">
<li><p>The list or source from which the sample is drawn.</p></li>
<li><p>Should represent the entire population.</p></li>
</ul>
</li>
<li><p><strong>Sample Size:</strong></p>
<ul class="simple">
<li><p>Balancing precision with practical considerations.</p></li>
<li><p>Larger samples increase representativeness but may be impractical.</p></li>
</ul>
</li>
<li><p><strong>Data Collection Tools:</strong></p>
<ul class="simple">
<li><p>Choosing appropriate instruments for measurement (surveys, interviews, etc.).</p></li>
<li><p>Depends on research objectives.</p></li>
</ul>
</li>
<li><p><strong>Ethical Considerations:</strong></p>
<ul class="simple">
<li><p>Ensuring participant rights through informed consent and confidentiality.</p></li>
<li><p>Adherence to ethical guidelines.</p></li>
</ul>
</li>
</ol>
<p>In conclusion, the choice between non-probability and probability methods depends on the research design, resources, and the level of representativeness required. Both methods have their strengths and limitations, and researchers must carefully consider these factors when selecting their data collection approach.</p>
</section>
<section id="monte-carlo-methods">
<h2>Monte Carlo methods<a class="headerlink" href="#monte-carlo-methods" title="Link to this heading">#</a></h2>
<p>Monte Carlo methods are simulation-based algorithms that rely on generating a large set
of samples from a statistical model to obtain the behaviour of the model and estimate
the quantities of interest. For a large sample set of a random variable representing a
quantity of interest, the law of large numbers allows to approximate the expectation by
the average value from the samples.</p>
<section id="connection-to-sampling-methods">
<h3>Connection to Sampling Methods<a class="headerlink" href="#connection-to-sampling-methods" title="Link to this heading">#</a></h3>
<p>Monte Carlo methods are fundamentally rooted in the concept of sampling methods. In both approaches, the objective is to draw samples from a population or a model to make inferences about that population or model. Sampling methods aim to obtain a representative subset from a larger population, allowing for statistical analysis and inference. Monte Carlo methods extend this idea by using random sampling to numerically solve problems that might be deterministic in nature, but where direct analytical solutions are difficult or impossible.</p>
<p>Consider repeated independent trials of a random experiment. We will need to generate a large number of samples <span class="math notranslate nohighlight">\(X_1, X_2, \ldots\)</span> from the model. A Monte Carlo method for estimating the expectation <span class="math notranslate nohighlight">\(E(X)\)</span> is a numerical method based on the approximation</p>
<div class="math notranslate nohighlight">
\[
E(X) \approx \frac{1}{N}\sum_{i=1}^N X_i,
\]</div>
<p>where <span class="math notranslate nohighlight">\(X_1, X_2, \ldots\)</span> are i.i.d. with the same distribution as <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>While computing expectations and computing probabilities at first look like different problems, the latter can be reduced to the former: if <span class="math notranslate nohighlight">\(X\)</span> is a random variable, we have</p>
<div class="math notranslate nohighlight">
\[
\Pr(X \in A) = E(1_A(X)).
\]</div>
<p>Using this equality, we can estimate <span class="math notranslate nohighlight">\(\Pr(X \in A)\)</span> by</p>
<div class="math notranslate nohighlight">
\[
\Pr(X \in A) = E(1_A(X)) = \frac{1}{N}\sum_{i=1}^N 1_A(X_i).
\]</div>
<p>Recall that the indicator function of the set <span class="math notranslate nohighlight">\(A\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
1_A(x) =
\begin{cases}
    1 &amp; \text{if } x \in A \\
    0 &amp; \text{otherwise}
\end{cases}
\end{split}\]</div>
</section>
</section>
<section id="monte-carlo-simulation-for-drawing-samples-from-a-standard-normal-distribution">
<h2>Monte Carlo Simulation for Drawing Samples from a Standard Normal Distribution<a class="headerlink" href="#monte-carlo-simulation-for-drawing-samples-from-a-standard-normal-distribution" title="Link to this heading">#</a></h2>
<p>Monte Carlo simulation is a versatile method used in statistical analysis and modeling to understand complex systems or processes through random sampling. When applied to draw samples from a standard normal distribution, which has a mean of 0 and a standard deviation of 1, Monte Carlo simulation can provide insights into the characteristics of the distribution of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Number of samples to draw</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="c1"># Generate N random samples from a standard normal distribution</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Plotting the histogram of samples</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Monte Carlo Simulation: Drawing Samples from a Standard Normal Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Statistical interpretation</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">std_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean of the samples: </span><span class="si">{</span><span class="n">mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviation of the samples: </span><span class="si">{</span><span class="n">std_dev</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bfc702b8857ed65b5f9107941ab677ffea2ee3473b43d2f765b6c7647ae514c2.png" src="_images/bfc702b8857ed65b5f9107941ab677ffea2ee3473b43d2f765b6c7647ae514c2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean of the samples: 0.0009668681409495975
Standard deviation of the samples: 1.0009009542948903
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-monte-carlo-methods-an-example">
<h2>Using Monte Carlo Methods: An Example<a class="headerlink" href="#using-monte-carlo-methods-an-example" title="Link to this heading">#</a></h2>
<p>Monte Carlo methods are powerful tools for solving complex problems using random sampling. These methods are particularly useful when dealing with high-dimensional integrals, probability distributions, or systems with a large number of possible states. To illustrate this, let’s consider a simple example: estimating the value of <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<section id="problem-explanation">
<h3>Problem Explanation<a class="headerlink" href="#problem-explanation" title="Link to this heading">#</a></h3>
<p>Estimating the value of <span class="math notranslate nohighlight">\(\pi\)</span> can be done using the Monte Carlo method by randomly generating points in a unit square and determining how many fall within a quarter circle inscribed within that square. The ratio of the number of points inside the quarter circle to the total number of points can be used to estimate <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>The mathematical idea is based on the area ratio:</p>
<ul class="simple">
<li><p>The area of the unit square is <span class="math notranslate nohighlight">\(1\)</span>.</p></li>
<li><p>The area of the quarter circle of radius <span class="math notranslate nohighlight">\(1\)</span> is <span class="math notranslate nohighlight">\(\frac{\pi}{4}\)</span>.</p></li>
</ul>
<p>Thus, if we generate <span class="math notranslate nohighlight">\(N\)</span> random points <span class="math notranslate nohighlight">\((x, y)\)</span> where <span class="math notranslate nohighlight">\(0 \leq x, y \leq 1\)</span>, the ratio of points that fall inside the quarter circle (<span class="math notranslate nohighlight">\(x^2 + y^2 \leq 1\)</span>) to the total number of points should approximate <span class="math notranslate nohighlight">\(\frac{\pi}{4}\)</span>. Therefore, <span class="math notranslate nohighlight">\(\pi \approx 4 \times \frac{\text{Number of points inside the quarter circle}}{N}\)</span>.</p>
</section>
<section id="python-code">
<h3>Python Code<a class="headerlink" href="#python-code" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Number of random points</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="c1"># Generate N random points in the unit square</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Calculate the number of points inside the quarter circle</span>
<span class="n">inside_circle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Estimate the value of pi</span>
<span class="n">pi_estimate</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">inside_circle</span> <span class="o">/</span> <span class="n">N</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated value of pi: </span><span class="si">{</span><span class="n">pi_estimate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Number of random points</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="c1"># Generate N random points in the unit square</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Calculate the number of points inside the quarter circle</span>
<span class="n">inside_circle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Estimate the value of pi</span>
<span class="n">pi_estimate</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">inside_circle</span> <span class="o">/</span> <span class="n">N</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated value of pi: </span><span class="si">{</span><span class="n">pi_estimate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated value of pi: 3.141864
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Number of random points</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Generate N random points in the unit square</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># Calculate the distance from the origin for each point</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Check if points are inside the quarter circle</span>
<span class="n">inside_circle</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">&lt;=</span> <span class="mi">1</span>

<span class="c1"># Estimate the value of pi</span>
<span class="n">pi_estimate</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">inside_circle</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated value of pi: </span><span class="si">{</span><span class="n">pi_estimate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inside Quarter Circle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">inside_circle</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outside Quarter Circle&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Estimating Pi using Monte Carlo Simulation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estimated value of pi: 3.1556
</pre></div>
</div>
<img alt="_images/662a1cdf71070245dea1d05c3f5a16b3e0a4c84868c832c66c3dd60ea685aa1f.png" src="_images/662a1cdf71070245dea1d05c3f5a16b3e0a4c84868c832c66c3dd60ea685aa1f.png" />
</div>
</div>
<div class="admonition-exercise-monte-carlo-simulation-with-poisson-distribution admonition">
<p class="admonition-title"><strong>Exercise: Monte Carlo Simulation with Poisson Distribution</strong></p>
<p><strong>Task:</strong></p>
<p>Perform a Monte Carlo simulation to generate random samples from a Poisson distribution and compare the results with the theoretical properties of the Poisson distribution.</p>
<p><strong>Questions to Address:</strong></p>
<p><strong>Simulation Setup:</strong></p>
<ul class="simple">
<li><p>Generate <code class="docutils literal notranslate"><span class="pre">N</span></code> random samples from a Poisson distribution with a given rate parameter λ.</p></li>
<li><p>Plot a histogram to visualize the distribution of the generated samples.</p></li>
</ul>
<p><strong>Comparison with Theoretical Distribution:</strong></p>
<ul class="simple">
<li><p>Calculate and plot the theoretical probability mass function (PMF) of the Poisson distribution with the same rate parameter λ.</p></li>
<li><p>Compare the histogram from the simulation with the theoretical PMF. Discuss any similarities or differences observed.</p></li>
</ul>
<p><strong>Statistical Properties:</strong></p>
<ul class="simple">
<li><p>Compute the mean and variance of the generated samples.</p></li>
<li><p>Compare these statistical properties with the theoretical mean (λ) and variance (λ) of the Poisson distribution. Discuss any discrepancies.</p></li>
</ul>
<p><strong>Exercise Steps:</strong></p>
<ol class="arabic simple">
<li><p><strong>Simulation Implementation:</strong></p>
<ul class="simple">
<li><p>Implement a Python function to perform the Monte Carlo simulation using NumPy for generating random samples from the Poisson distribution.</p></li>
</ul>
</li>
<li><p><strong>Visualization:</strong></p>
<ul class="simple">
<li><p>Use matplotlib to plot the histogram of the generated samples and overlay the theoretical PMF curve of the Poisson distribution.</p></li>
</ul>
</li>
<li><p><strong>Analysis and Interpretation:</strong></p>
<ul class="simple">
<li><p>Compute the mean and variance of the generated samples.</p></li>
<li><p>Compare these values with the theoretical mean and variance of the Poisson distribution.</p></li>
<li><p>Discuss the accuracy of the simulation in approximating the Poisson distribution.</p></li>
</ul>
</li>
</ol>
</div>
</section>
</section>
<section id="sampling-methods-in-python">
<h2><span style="color: dimgray;"><strong>Sampling Methods in Python</strong></span><a class="headerlink" href="#sampling-methods-in-python" title="Link to this heading">#</a></h2>
<p>This section explores various techniques for obtaining subsets of data from larger datasets using the Python programming language. Understanding and implementing these sampling methods is fundamental to achieving accurate and reliable insights from data, contributing to the robustness of statistical analyses and research findings.</p>
<section id="simple-random-sampling-in-python">
<h3><span style="color: dimgray;"><strong>Simple Random Sampling in Python</strong></span><a class="headerlink" href="#simple-random-sampling-in-python" title="Link to this heading">#</a></h3>
<p>To obtain a random sample, one can sequentially label all cases and generate uniformly distributed random numbers for selecting cases from the population.</p>
<p>In Python, a simple random sample can be generated using the random.sample() function from the random module. The function is defined as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Sample usage:</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  <span class="c1"># Example population</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Example sample size</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Sample usage:</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  <span class="c1"># Example population</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Example sample size</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[64, 44, 42, 37, 12, 32, 10, 26, 92, 66]
</pre></div>
</div>
</div>
</div>
<p>In this code:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is the population from which you want to sample.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> is the number of samples you want to draw.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">random.sample()</span></code> returns a list of unique items from the population. If you want to allow sampling with replacement, you would need a different approach, such as using <code class="docutils literal notranslate"><span class="pre">random.choices()</span></code>.</p></li>
</ul>
</section>
<section id="numpy-s-random-choice">
<h3>NumPy’s <code class="docutils literal notranslate"><span class="pre">random.choice()</span></code><a class="headerlink" href="#numpy-s-random-choice" title="Link to this heading">#</a></h3>
<p>This code is an alternative to using <code class="docutils literal notranslate"><span class="pre">random.sample()</span></code> and provides similar functionality using NumPy’s <code class="docutils literal notranslate"><span class="pre">random.choice()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Sample usage:</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  <span class="c1"># Example population</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Example sample size</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Sample usage:</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>  <span class="c1"># Example population</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Example sample size</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[48 96 57 73 68 88 83 23 36 37]
</pre></div>
</div>
</div>
</div>
<p>In this code:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is the population from which you want to sample, created using <code class="docutils literal notranslate"><span class="pre">np.arange</span></code> to generate an array from 1 to 100.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> is the number of samples you want to draw.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">np.random.choice(x,</span> <span class="pre">size,</span> <span class="pre">replace=False)</span></code> returns an array of unique items from the population. If you want to allow sampling with replacement, set <code class="docutils literal notranslate"><span class="pre">replace=True</span></code>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can use other functions from the <code class="docutils literal notranslate"><span class="pre">random</span></code> module in Python depending on your needs. Here are a few common functions and their uses:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">random.random()</span></code></strong>: Returns a random floating point number in the range [0.0, 1.0).</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">random_number</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

<span class="mf">2.</span> <span class="err">`</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="err">`</span><span class="p">:</span> <span class="n">Returns</span> <span class="n">a</span> <span class="n">random</span> <span class="n">integer</span> <span class="n">between</span> <span class="err">`</span><span class="n">a</span><span class="err">`</span> <span class="ow">and</span> <span class="err">`</span><span class="n">b</span><span class="err">`</span> <span class="p">(</span><span class="n">inclusive</span><span class="p">)</span><span class="o">.</span>

<span class="err">```</span><span class="n">python</span>
<span class="n">random_integer</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>


<span class="mf">3.</span> <span class="err">`</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="err">`</span><span class="p">:</span> <span class="n">Returns</span> <span class="n">a</span> <span class="n">random</span> <span class="n">element</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">non</span><span class="o">-</span><span class="n">empty</span> <span class="n">sequence</span> <span class="err">`</span><span class="n">seq</span><span class="err">`</span><span class="o">.</span>

<span class="err">```</span><span class="n">python</span>
<span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;cherry&#39;</span><span class="p">]</span>
<span class="n">random_item</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

<span class="mf">4.</span> <span class="err">`</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="err">`</span><span class="p">:</span> <span class="n">Shuffles</span> <span class="n">the</span> <span class="n">elements</span> <span class="n">of</span> <span class="nb">list</span> <span class="err">`</span><span class="n">x</span><span class="err">`</span> <span class="ow">in</span> <span class="n">place</span><span class="o">.</span>

<span class="err">```</span><span class="n">python</span>
<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="pandas-sample-for-sampling-without-replacement">
<h3>Pandas <code class="docutils literal notranslate"><span class="pre">.sample()</span></code> for Sampling Without Replacement<a class="headerlink" href="#pandas-sample-for-sampling-without-replacement" title="Link to this heading">#</a></h3>
<p>If you want to achieve similar functionality to <code class="docutils literal notranslate"><span class="pre">np.random.choice()</span></code> using Pandas’ <code class="docutils literal notranslate"><span class="pre">.sample()</span></code> method for sampling without replacement, you can refactor the code as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Example population</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">))</span>  <span class="c1"># Convert NumPy array to Pandas Series</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Example sample size</span>

<span class="c1"># Sample using Pandas .sample() method</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>  <span class="c1"># Convert Pandas Series to NumPy array and print</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[99 69 63 68 17 60 43 48 76 31]
</pre></div>
</div>
</div>
</div>
<p>Explanation:
Population Definition: Here, x is defined as a Pandas Series containing values from 1 to 100. It’s created using pd.Series(np.arange(1, 101)), which converts a NumPy array (np.arange(1, 101)) into a Pandas Series.</p>
<p>Sampling:</p>
<ul class="simple">
<li><p>The .sample() method of Pandas Series is used to randomly select size number of elements (10 in this example) from the Series x.</p></li>
<li><p>replace=False ensures sampling without replacement, meaning each selected element is unique within the sample.</p></li>
</ul>
<p>Output:</p>
<ul class="simple">
<li><p>sample.values is used to access the underlying NumPy array of sampled values from the Pandas Series, similar to how np.random.choice() returns a NumPy array.</p></li>
</ul>
<p>This approach leverages Pandas’ .sample() method, providing a seamless integration with Pandas Series for sampling data without replacement, aligning with the functionality of np.random.choice() in NumPy.</p>
<div class="admonition-example-7 admonition">
<p class="admonition-title"><strong>Example 7</strong></p>
<p>How can the acceptability of a sample, drawn through simple random sampling from a normal distribution with a given mean (<span class="math notranslate nohighlight">\(\mu\)</span>) and standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>), be evaluated? The evaluation includes comparing histograms and conducting basic statistical checks to ensure the sample adequately represents the population.</p>
<ul class="simple">
<li><p><strong>Objective:</strong> Evaluate the acceptability of a sample drawn through simple random sampling from a normal distribution.</p></li>
<li><p><strong>Tasks:</strong></p>
<ol class="arabic simple">
<li><p>Generate a large population (<span class="math notranslate nohighlight">\(N\)</span>) following a normal distribution with a specified mean (<span class="math notranslate nohighlight">\(\mu\)</span>) and standard deviation (<span class="math notranslate nohighlight">\(\sigma\)</span>).</p></li>
<li><p>Draw a sample (<span class="math notranslate nohighlight">\(n\)</span>) from the population using simple random sampling.</p></li>
<li><p>Compare the histograms of the population and the sample to visually inspect their distributions.</p></li>
<li><p>Perform basic statistical checks, including calculating means and variances, to assess the representativeness of the sample.</p></li>
<li><p>Optionally, conduct a t-test to further validate the similarity between the sample and the population.</p></li>
</ol>
</li>
</ul>
</div>
</section>
<section id="step-1-generate-a-large-population">
<h3>Step 1: Generate a large population<a class="headerlink" href="#step-1-generate-a-large-population" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We use NumPy’s <code class="docutils literal notranslate"><span class="pre">np.random.normal</span></code> function to generate a large population (<code class="docutils literal notranslate"><span class="pre">population_size</span></code>) following a normal distribution with mean (<code class="docutils literal notranslate"><span class="pre">population_mean</span></code>) and standard deviation (<code class="docutils literal notranslate"><span class="pre">population_std</span></code>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Parameters for the population</span>
<span class="n">population_mean</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">population_std</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">population_size</span> <span class="o">=</span> <span class="mi">100000</span>  <span class="c1"># Large population size</span>

<span class="c1"># Generate the population</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">population_mean</span><span class="p">,</span> <span class="n">population_std</span><span class="p">,</span> <span class="n">population_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-draw-a-sample-using-simple-random-sampling">
<h3>Step 2: Draw a sample using simple random sampling<a class="headerlink" href="#step-2-draw-a-sample-using-simple-random-sampling" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We use <code class="docutils literal notranslate"><span class="pre">np.random.choice</span></code> to draw a sample (<code class="docutils literal notranslate"><span class="pre">sample_size</span></code>) from the <code class="docutils literal notranslate"><span class="pre">population</span></code> without replacement, ensuring it’s a simple random sample.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters for the sample</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Size of the sample</span>

<span class="c1"># Draw a simple random sample from the population</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-compare-histograms-of-population-and-sample">
<h3>Step 3: Compare histograms of population and sample<a class="headerlink" href="#step-3-compare-histograms-of-population-and-sample" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We use Matplotlib to create histograms of both the <code class="docutils literal notranslate"><span class="pre">population</span></code> and <code class="docutils literal notranslate"><span class="pre">sample</span></code> distributions.</p></li>
<li><p>This visual inspection helps us compare the shapes and central tendencies of the two distributions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plot histograms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Population Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b8542a8fa6e8234defeaef51acecfb88bc8cc8adca9894c31b5dfb910492ee4c.png" src="_images/b8542a8fa6e8234defeaef51acecfb88bc8cc8adca9894c31b5dfb910492ee4c.png" />
</div>
</div>
</section>
<section id="step-4-perform-basic-statistical-checks">
<h3>Step 4: Perform basic statistical checks<a class="headerlink" href="#step-4-perform-basic-statistical-checks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We calculate and compare the means and variances of the <code class="docutils literal notranslate"><span class="pre">population</span></code> and <code class="docutils literal notranslate"><span class="pre">sample</span></code>.</p></li>
<li><p>This helps us assess how closely the sample statistics reflect the population parameters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate means and variances</span>
<span class="n">population_mean_calculated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>
<span class="n">population_var_calculated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">population</span><span class="p">)</span>

<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">sample_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Population Mean (Actual): </span><span class="si">{</span><span class="n">population_mean</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Population Mean (Calculated): </span><span class="si">{</span><span class="n">population_mean_calculated</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Population Variance (Calculated): </span><span class="si">{</span><span class="n">population_var_calculated</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Mean: </span><span class="si">{</span><span class="n">sample_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Variance: </span><span class="si">{</span><span class="n">sample_var</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Population Mean (Actual): 50
Population Mean (Calculated): 50.01
Population Variance (Calculated): 100.18

Sample Mean: 49.90
Sample Variance: 102.13
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-5-optionally-conduct-a-t-test">
<h3>Step 5: Optionally, conduct a t-test<a class="headerlink" href="#step-5-optionally-conduct-a-t-test" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We use <code class="docutils literal notranslate"><span class="pre">scipy.stats.ttest_1samp</span></code> to perform a one-sample t-test comparing the sample mean against the population mean.</p></li>
<li><p>The t-statistic measures how much the sample mean differs from the population mean, and the p-value indicates the significance of this difference.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_1samp</span>

<span class="c1"># Perform t-test</span>
<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">population_mean</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>t-statistic: -0.31
p-value: 0.7572
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpretation-of-t-test-results">
<h3>Interpretation of t-test results<a class="headerlink" href="#interpretation-of-t-test-results" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>t-statistic</strong>: The t-statistic measures how much the sample mean differs from the population mean, relative to the variability in the sample. In this case, the t-statistic is -0.31.</p>
<ul>
<li><p>A negative t-statistic indicates that the sample mean is slightly below the population mean.</p></li>
</ul>
</li>
<li><p><strong>p-value</strong>: The p-value indicates the probability of observing a t-statistic as extreme as the one calculated, under the assumption that the null hypothesis is true (i.e., that there is no difference between the sample mean and the population mean). Here, the p-value is 0.7572.</p>
<ul>
<li><p>A high p-value suggests that we fail to reject the null hypothesis. In practical terms, this means that the sample mean is not significantly different from the population mean at the conventional levels of significance (e.g., α = 0.05 or 0.01).</p></li>
</ul>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Therefore, based on these results, we can accept that the sample drawn through simple random sampling adequately represents the population mean.</p>
<p>The high p-value indicates that we do not have sufficient evidence to reject the null hypothesis, which is that the sample mean is not significantly different from the population mean.</p>
<p>Thus, the sample is considered acceptable for representing the population mean in this scenario.
``</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Null Hypothesis for T-Test:</strong></p>
<p><span class="math notranslate nohighlight">\( H_0: \mu_{\text{sample}} = \mu_{\text{population}} \)</span></p>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \mu_{\text{sample}} \)</span> is the mean of the sample.</p></li>
<li><p><span class="math notranslate nohighlight">\( \mu_{\text{population}} \)</span> is the known or hypothesized mean of the population.</p></li>
</ul>
<p>The null hypothesis posits that there is no significant difference between the mean of the sample and the specified mean of the population. The t-test will assess whether any observed differences are statistically significant or if they could likely occur due to random sampling variability.</p>
<p><strong>Conclusion from T-Test:</strong></p>
<p>With a p-value of 0.7572 obtained from the t-test, we fail to reject the null hypothesis (<span class="math notranslate nohighlight">\( H_0: \mu_{\text{sample}} = \mu_{\text{population}} \)</span>). This suggests that there is not enough statistical evidence to conclude that the mean of the sample is significantly different from the specified mean of the population. The observed differences are likely attributable to random sampling variability.</p>
</div>
</section>
<section id="summary">
<h3><strong>Summary</strong><a class="headerlink" href="#summary" title="Link to this heading">#</a></h3>
<p>These steps provide a comprehensive approach to evaluating a sample drawn from a normal distribution in Python. Each part involves generating data, visualizing distributions, calculating statistics, and optionally performing hypothesis testing to ensure the sample adequately represents the population.</p>
</section>
<section id="stratified-sampling-in-r">
<h3><span style="color: dimgray;"><strong>Stratified Sampling in R</strong></span><a class="headerlink" href="#stratified-sampling-in-r" title="Link to this heading">#</a></h3>
<p>In stratified sampling, the population is divided into smaller subgroups, or strata, based on common factors such as age, gender, income, etc. These strata are designed to accurately represent the overall population.</p>
<p>For instance, when examining the daily time spent on messaging for male and female users, the strata may be defined as male and female users, and random sampling is then applied within each gender stratum.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It’s important to note that while stratified sampling provides more precise estimates compared to random sampling, a major drawback is the need for knowledge about the specific characteristics of the population, which may not always be readily available. Additionally, determining the appropriate characteristics for stratification can pose challenges.</p>
</div>
<section id="balanced-and-imbalanced-dataset">
<h4><span style="color: dimgray;"><strong>Balanced and Imbalanced Dataset</strong></span><a class="headerlink" href="#balanced-and-imbalanced-dataset" title="Link to this heading">#</a></h4>
<p>In the following examples, we will create two different synthetic datasets and implement stratified sampling, a technique crucial for <strong>maintaining proportional representation within distinct subgroups or strata</strong>.</p>
<p>The initial dataset, representing a balanced distribution, guarantees that each category is evenly presented within its own subgroup. This creates an inclusive learning environment where all classes have a fair presence.</p>
<p>Conversely, the second dataset deliberately introduces an imbalance. Here, certain classes are intentionally presented in smaller numbers within their respective subgroups. This intentional imbalance reflects real-world situations where certain scenarios require focused attention on specific classes.</p>
<p>Stratified sampling becomes essential in preserving proportional class representation within each subgroup, a methodology particularly valuable in both balanced and imbalanced cases.</p>
<ul class="simple">
<li><p><strong>Balanced Dataset:</strong> A balanced dataset is characterized by an equal or nearly equal distribution of instances across different classes or categories. In other words, each class in the dataset has a comparable number of samples.</p></li>
<li><p><strong>Imbalanced Dataset:</strong> An imbalanced dataset occurs when the number of instances in different classes significantly varies. One or more classes might be underrepresented, making it challenging for a model to learn patterns associated with the minority class(es).</p></li>
</ul>
<p>Here we will use Scikit-learn for stratified sampling. Note that you will see this in more details later in the chapter on Introduction to Machine Leaning.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> module in Scikit-learn sets up <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> (folds, partitions or groups) of the dataset in a way that the folds are made by <strong>preserving the percentage of samples for each class</strong>.</p>
<p>The brief explaination for the code below (also see the diagram below) is as follows:</p>
<ol class="arabic simple">
<li><p>The dataset has been split into K (K = 2 in our example) equal  partitions (or folds).</p></li>
<li><p>(In iteration 1) use fold 1 as the testing set and the union of the other folds as the training set.</p></li>
<li><p>Repeat step 2 for K times, using a different fold as the testing set each time.</p></li>
</ol>
<p><img alt="Image from gcumedia" src="https://www.researchgate.net/profile/Mingchao-Li/publication/331209203/figure/fig2/AS:728070977748994&#64;1550597056956/K-fold-cross-validation-method_W640.jpg" /></p>
<p>Image source: <a class="reference external" href="https://www.researchgate.net/profile/Mingchao-Li/publication/331209203/figure/fig2/AS:728070977748994&#64;1550597056956/K-fold-cross-validation-method_W640.jpg">https://www.researchgate.net/profile/Mingchao-Li/publication/331209203/figure/fig2/AS:728070977748994&#64;1550597056956/K-fold-cross-validation-method_W640.jpg</a></p>
<div class="admonition-example-8-synthetic-balanced-datasets admonition">
<p class="admonition-title"><strong>Example 8</strong> Synthetic balanced datasets</p>
<p>We aim to perform stratified sampling on a synthetic balanced dataset using Python. The dataset contains two classes, “ClassA” and “ClassB,” and we intend to create a representative sample while maintaining the balance between the classes. The following tasks will be executed:</p>
<ul class="simple">
<li><p><strong>Tasks for Stratified Sampling on Synthetic Imbalanced Datasets:</strong></p></li>
</ul>
<ol class="arabic simple">
<li><p><strong>Install and Import Libraries:</strong></p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> to install necessary libraries (<code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>).</p></li>
<li><p>Import libraries for data manipulation (<code class="docutils literal notranslate"><span class="pre">pandas</span></code>).</p></li>
</ul>
</li>
<li><p><strong>Create a Balanced Dataset:</strong></p>
<ul class="simple">
<li><p>Generate a synthetic dataset with two features, “feature1” and “feature2,” and 200 observations.</p></li>
<li><p>The dataset is balanced, with 100 instances for each class.</p></li>
</ul>
</li>
<li><p><strong>Stratified Sampling:</strong></p>
<ul class="simple">
<li><p>Utilize <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn.model_selection</span></code> to perform stratified sampling.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">n_splits</span> <span class="pre">&gt;=</span> <span class="pre">2</span></code> to create multiple folds for cross-validation or multiple samples.     - This will ensure that the sample maintains the balance between classes.</p></li>
</ul>
</li>
<li><p><strong>Display the Result:</strong></p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.bincount()</span></code> to display the counts or proportions of each class within the sampled data subgroups.</p></li>
<li><p>This will provide insights into the distribution of classes within the stratified sample, considering the intentional imbalance in the dataset.</p></li>
</ul>
</li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Create a balanced dataset</span>
<span class="n">data_balanced</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;feature2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
    <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="s2">&quot;ClassA&quot;</span><span class="p">,</span> <span class="s2">&quot;ClassB&quot;</span><span class="p">],</span> <span class="n">repeats</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">})</span>

<span class="c1"># Initialize StratifiedKFold for sampling</span>
<span class="n">stratified_kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>  <span class="c1"># Setting n_splits to 2 for example</span>

<span class="c1"># Perform stratified sampling</span>
<span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">stratified_kfold</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data_balanced</span><span class="p">[[</span><span class="s1">&#39;feature1&#39;</span><span class="p">,</span> <span class="s1">&#39;feature2&#39;</span><span class="p">]],</span> <span class="n">data_balanced</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]):</span>
    <span class="n">sampled_data_balanced</span> <span class="o">=</span> <span class="n">data_balanced</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

<span class="c1"># Display the result (optional)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sampled_data_balanced</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>


<span class="c1"># Display train/test indices</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TRAIN INDEX: </span><span class="si">{</span><span class="n">train_index</span><span class="si">}</span><span class="s2"> TEST INDEX: </span><span class="si">{</span><span class="n">test_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>class
ClassA    0.5
ClassB    0.5
Name: proportion, dtype: float64
TRAIN INDEX: [ 0  1  5  6  9 10 12 13 18 19] TEST INDEX: [ 2  3  4  7  8 11 14 15 16 17]
</pre></div>
</div>
</div>
</div>
<p>Explanation:</p>
<ul class="simple">
<li><p><strong>n_splits</strong>: This parameter specifies the number of folds or splits you want to create from the dataset. Typically, <code class="docutils literal notranslate"><span class="pre">n_splits</span> <span class="pre">&gt;=</span> <span class="pre">2</span></code> ensures that the dataset is divided into multiple samples.</p></li>
<li><p><strong>shuffle=True</strong>: This parameter shuffles the data before splitting, ensuring that the order of samples does not affect the stratification.</p></li>
<li><p><strong>stratified_kfold.split()</strong>: This method generates indices for each split based on the stratification of the target variable (<code class="docutils literal notranslate"><span class="pre">data_balanced['class']</span></code> in this case).</p></li>
<li><p><strong>sampled_data_balanced[‘class’].value_counts(normalize=True)</strong>: Calculates and prints the normalized value counts of each class in the sampled dataset, providing insights into the class distribution within the stratified sample. When you use <code class="docutils literal notranslate"><span class="pre">.value_counts(normalize=True)</span></code> on a pandas Series, it calculates and returns the relative frequencies of unique values rather than their counts. This means each unique value’s count is divided by the total number of observations, giving you proportions instead of raw counts.</p></li>
</ul>
<p>Adjust <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> according to your specific sampling needs. Setting <code class="docutils literal notranslate"><span class="pre">n_splits=1</span></code> effectively means no splitting is performed, which isn’t suitable for typical use cases of <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code>. For simple stratified sampling without cross-validation, consider <code class="docutils literal notranslate"><span class="pre">StratifiedShuffleSplit</span></code> instead, as it directly supports sampling without needing multiple splits.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We create <code class="docutils literal notranslate"><span class="pre">sampled_data_balanced</span></code> by selecting data from <code class="docutils literal notranslate"><span class="pre">data_balanced</span></code> using <code class="docutils literal notranslate"><span class="pre">test_index</span></code> during stratified sampling.</p>
<p>In the obtained result for the balanced case, the stratified sampling successfully yielded a distribution of classes where both ‘ClassA’ and ‘ClassB’ are evenly represented, each constituting 50% of the stratified sample.</p>
</div>
<hr style="border: 2px solid #333;"><div class="admonition-example-9-synthetic-imbalanced-datasets admonition">
<p class="admonition-title"><strong>Example 9</strong> Synthetic imbalanced datasets</p>
<p>We aim to perform stratified sampling on a synthetic imbalanced dataset using Python. The dataset comprises two classes, “ClassA” and “ClassB,” intentionally structured to demonstrate imbalance. The objective is to create a representative sample while acknowledging and addressing the intentional underrepresentation of specific classes within their respective subgroups.</p>
<h3 class="rubric" id="tasks-for-stratified-sampling-on-synthetic-imbalanced-datasets">Tasks for Stratified Sampling on Synthetic Imbalanced Datasets</h3>
<ol class="arabic simple">
<li><p><strong>Install and Import Libraries:</strong></p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> to install necessary libraries (<code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>).</p></li>
<li><p>Import libraries for data manipulation (<code class="docutils literal notranslate"><span class="pre">pandas</span></code>).</p></li>
</ul>
</li>
<li><p><strong>Create an Imbalanced Dataset:</strong></p>
<ul class="simple">
<li><p>Generate a synthetic dataset with two features, “feature1” and “feature2,” and 200 observations.</p></li>
<li><p>Intentionally structure the dataset to illustrate imbalance, with specific classes deliberately underrepresented within their corresponding subgroups.</p></li>
</ul>
</li>
<li><p><strong>Stratified Sampling for Imbalanced Dataset:</strong></p>
<ul class="simple">
<li><p>Utilize <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn.model_selection</span></code> to perform stratified sampling.</p></li>
<li><p>Specify the number of folds (<code class="docutils literal notranslate"><span class="pre">n_splits</span></code>) and adjust as needed to address the dataset’s imbalance.</p></li>
</ul>
</li>
<li><p><strong>Display the Result:</strong></p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.bincount()</span></code> to present the counts or proportions of each class within the sampled data subgroups.</p></li>
<li><p>This will provide insights into the distribution of classes within the stratified sample, considering the intentional imbalance in the dataset.</p></li>
</ul>
</li>
</ol>
<p>Adjust parameters and explore various sampling strategies based on the specific requirements of your imbalanced dataset.</p>
</div>
<p>Here’s the Python code using StratifiedKFold to perform stratified sampling on a synthetic imbalanced dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Create an imbalanced dataset</span>
<span class="n">data_imbalanced</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;feature1&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;feature2&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;ClassA&quot;</span><span class="p">,</span> <span class="s2">&quot;ClassB&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>  <span class="c1"># Intentionally imbalanced</span>
<span class="p">})</span>

<span class="c1"># Initialize StratifiedKFold for sampling</span>
<span class="n">stratified_kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Perform stratified sampling</span>
<span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">stratified_kfold</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">data_imbalanced</span><span class="p">[[</span><span class="s1">&#39;feature1&#39;</span><span class="p">,</span> <span class="s1">&#39;feature2&#39;</span><span class="p">]],</span> <span class="n">data_imbalanced</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]):</span>
    <span class="n">sampled_data_imbalanced</span> <span class="o">=</span> <span class="n">data_imbalanced</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>

<span class="c1"># Display the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sampled_data_imbalanced</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Display train/test indices</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;TRAIN INDEX: </span><span class="si">{</span><span class="n">train_index</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> TEST INDEX: </span><span class="si">{</span><span class="n">test_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>class
ClassB    0.78
ClassA    0.22
Name: proportion, dtype: float64
TRAIN INDEX: [ 3  4  6  7  8 10 13 16 23 24 26 28 30 32 33 35 37 40 42 43 44 45 46 48
 53 54 55 57 59 61 62 63 64 65 66 67 69 73 74 76 80 83 87 88 89 91 92 93
 96 98] 
 TEST INDEX: [ 0  1  2  5  9 11 12 14 15 17 18 19 20 21 22 25 27 29 31 34 36 38 39 41
 47 49 50 51 52 56 58 60 68 70 71 72 75 77 78 79 81 82 84 85 86 90 94 95
 97 99]
</pre></div>
</div>
</div>
</div>
<p>Explanation:</p>
<ul class="simple">
<li><p><strong>np.random.choice</strong>: Generates a random sample from <code class="docutils literal notranslate"><span class="pre">[&quot;ClassA&quot;,</span> <span class="pre">&quot;ClassB&quot;]</span></code> with probabilities <code class="docutils literal notranslate"><span class="pre">[0.2,</span> <span class="pre">0.8]</span></code>, intentionally creating an imbalanced dataset.</p></li>
<li><p><strong>StratifiedKFold</strong>: Initializes the stratified k-fold cross-validator with <code class="docutils literal notranslate"><span class="pre">n_splits=2</span></code>, ensuring that the dataset is divided into 2 folds while preserving the class distribution.</p></li>
<li><p><strong>stratified_kfold.split()</strong>: Generates indices for each fold based on the stratification of the target variable (<code class="docutils literal notranslate"><span class="pre">data_imbalanced['class']</span></code>).</p></li>
<li><p><strong>sampled_data_imbalanced[‘class’].value_counts(normalize=True)</strong>: Calculates and prints the normalized value counts of each class in the sampled dataset, providing insights into the class distribution within the stratified sample.</p></li>
</ul>
<p>Adjust the parameters (<code class="docutils literal notranslate"><span class="pre">n_splits</span></code>, <code class="docutils literal notranslate"><span class="pre">random_state</span></code>, etc.) according to your specific sampling requirements and dataset characteristics. This approach effectively demonstrates how to perform stratified sampling on an imbalanced dataset using Python and <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> from scikit-learn.</p>
</section>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="simple-random-sampling-srs-in-python">
<h3>Simple Random Sampling (SRS) in Python:<a class="headerlink" href="#simple-random-sampling-srs-in-python" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Question 1: Simple Random Sampling from a Dataset</strong></p>
<ul class="simple">
<li><p>Task: Write Python code to perform simple random sampling on a real dataset.</p></li>
<li><p>Dataset: Use the “iris” dataset from <code class="docutils literal notranslate"><span class="pre">sklearn.datasets</span></code>.</p></li>
<li><p>Requirements:</p>
<ul>
<li><p>Import the dataset.</p></li>
<li><p>Implement a function to perform simple random sampling with a specified sample size.</p></li>
<li><p>Print the sample.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Question 2: Evaluation of Simple Random Sampling</strong></p>
<ul class="simple">
<li><p>Task: Compare the characteristics of the original dataset with the sampled dataset.</p></li>
<li><p>Dataset: Use the “wine” dataset from <code class="docutils literal notranslate"><span class="pre">sklearn.datasets</span></code>.</p></li>
<li><p>Requirements:</p>
<ul>
<li><p>Compute and print summary statistics (mean, standard deviation) for a selected feature from both the original and sampled datasets.</p></li>
<li><p>Discuss any differences observed between the statistics of the original and sampled datasets.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
</section>
<section id="stratified-sampling-in-python">
<h3>Stratified Sampling in Python:<a class="headerlink" href="#stratified-sampling-in-python" title="Link to this heading">#</a></h3>
<ol class="arabic simple" start="3">
<li><p><strong>Question 3: Stratified Sampling Implementation</strong></p>
<ul class="simple">
<li><p>Task: Implement stratified sampling on a real dataset.</p></li>
<li><p>Dataset: Use the “digits” dataset from <code class="docutils literal notranslate"><span class="pre">sklearn.datasets</span></code>.</p></li>
<li><p>Requirements:</p>
<ul>
<li><p>Import the dataset.</p></li>
<li><p>Implement a function to perform stratified sampling based on a selected target variable (e.g., target classes).</p></li>
<li><p>Print the samples from each stratum.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Question 4: Comparison of Sampling Methods</strong></p>
<ul class="simple">
<li><p>Task: Compare the effectiveness of stratified sampling versus simple random sampling.</p></li>
<li><p>Dataset: Use the “breast_cancer” dataset from <code class="docutils literal notranslate"><span class="pre">sklearn.datasets</span></code>.</p></li>
<li><p>Requirements:</p>
<ul>
<li><p>Perform both stratified sampling and simple random sampling on a selected feature or target variable.</p></li>
<li><p>Calculate and print summary statistics (mean, standard deviation) for both sampling methods.</p></li>
<li><p>Discuss which sampling method would be more appropriate in different scenarios based on the dataset characteristics.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
</section>
<section id="answer-to-question-1-simple-random-sampling-from-a-dataset">
<h3><strong>Answer to Question 1: Simple Random Sampling from a Dataset</strong><a class="headerlink" href="#answer-to-question-1-simple-random-sampling-from-a-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load the iris dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>

<span class="c1"># Function to perform simple random sampling</span>
<span class="k">def</span> <span class="nf">simple_random_sampling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">random_seed</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sample</span>

<span class="c1"># Perform simple random sampling</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Specify the sample size</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">simple_random_sampling</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Print the sample</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simple Random Sample:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>


<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load the iris dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>

<span class="c1"># Function to perform simple random sampling</span>
<span class="k">def</span> <span class="nf">simple_random_sampling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">random_seed</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sample</span>

<span class="c1"># Perform simple random sampling</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Specify the sample size</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">simple_random_sampling</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Print the sample</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simple Random Sample:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simple Random Sample:
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)  \
73                 6.1               2.8                4.7               1.2   
18                 5.7               3.8                1.7               0.3   
118                7.7               2.6                6.9               2.3   
78                 6.0               2.9                4.5               1.5   
76                 6.8               2.8                4.8               1.4   
31                 5.4               3.4                1.5               0.4   
64                 5.6               2.9                3.6               1.3   
141                6.9               3.1                5.1               2.3   
68                 6.2               2.2                4.5               1.5   
82                 5.8               2.7                3.9               1.2   
110                6.5               3.2                5.1               2.0   
12                 4.8               3.0                1.4               0.1   
36                 5.5               3.5                1.3               0.2   
9                  4.9               3.1                1.5               0.1   
19                 5.1               3.8                1.5               0.3   
56                 6.3               3.3                4.7               1.6   
104                6.5               3.0                5.8               2.2   
69                 5.6               2.5                3.9               1.1   
55                 5.7               2.8                4.5               1.3   
132                6.4               2.8                5.6               2.2   

     target  
73      1.0  
18      0.0  
118     2.0  
78      1.0  
76      1.0  
31      0.0  
64      1.0  
141     2.0  
68      1.0  
82      1.0  
110     2.0  
12      0.0  
36      0.0  
9       0.0  
19      0.0  
56      1.0  
104     2.0  
69      1.0  
55      1.0  
132     2.0  
Simple Random Sample:
     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)  \
73                 6.1               2.8                4.7               1.2   
18                 5.7               3.8                1.7               0.3   
118                7.7               2.6                6.9               2.3   
78                 6.0               2.9                4.5               1.5   
76                 6.8               2.8                4.8               1.4   
31                 5.4               3.4                1.5               0.4   
64                 5.6               2.9                3.6               1.3   
141                6.9               3.1                5.1               2.3   
68                 6.2               2.2                4.5               1.5   
82                 5.8               2.7                3.9               1.2   
110                6.5               3.2                5.1               2.0   
12                 4.8               3.0                1.4               0.1   
36                 5.5               3.5                1.3               0.2   
9                  4.9               3.1                1.5               0.1   
19                 5.1               3.8                1.5               0.3   
56                 6.3               3.3                4.7               1.6   
104                6.5               3.0                5.8               2.2   
69                 5.6               2.5                3.9               1.1   
55                 5.7               2.8                4.5               1.3   
132                6.4               2.8                5.6               2.2   

     target  
73      1.0  
18      0.0  
118     2.0  
78      1.0  
76      1.0  
31      0.0  
64      1.0  
141     2.0  
68      1.0  
82      1.0  
110     2.0  
12      0.0  
36      0.0  
9       0.0  
19      0.0  
56      1.0  
104     2.0  
69      1.0  
55      1.0  
132     2.0  
</pre></div>
</div>
</div>
</div>
<p>Insight from Results:</p>
<ul class="simple">
<li><p>By comparing the sampled dataset (<code class="docutils literal notranslate"><span class="pre">sample</span></code>) with the original dataset (<code class="docutils literal notranslate"><span class="pre">df</span></code>), we can observe how well our sample represents the characteristics of the entire dataset.</p></li>
<li><p>Insight can be gained regarding the variability and distribution of the selected features within the sample compared to the population.</p></li>
<li><p>Statistical measures such as mean, standard deviation, and other summary statistics can reveal similarities or differences in the distribution of data points between the sample and the original dataset.</p></li>
<li><p>This exercise helps in understanding how sampling affects data representation and is crucial for tasks like hypothesis testing and predictive modeling, where having a representative sample is essential for accurate conclusions.</p></li>
</ul>
</section>
<section id="answer-to-question-2-evaluation-of-simple-random-sampling-srs">
<h3><strong>Answer to Question 2: Evaluation of Simple Random Sampling (SRS)</strong><a class="headerlink" href="#answer-to-question-2-evaluation-of-simple-random-sampling-srs" title="Link to this heading">#</a></h3>
<p>Here’s the code and explanation for Question 2, which involves evaluating Simple Random Sampling (SRS) on the “wine” dataset and comparing it with the original dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_wine</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load the wine dataset</span>
<span class="n">wine</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">wine</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">wine</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span> <span class="n">wine</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>

<span class="c1"># Function to perform simple random sampling</span>
<span class="k">def</span> <span class="nf">simple_random_sampling</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">random_seed</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">sample_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sample</span>

<span class="c1"># Perform simple random sampling</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># Specify the sample size</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">simple_random_sampling</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Compute summary statistics</span>
<span class="n">original_mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;alcohol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sampled_mean</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;alcohol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">original_std</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;alcohol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">sampled_std</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;alcohol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Print summary statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Dataset:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">original_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Standard Deviation: </span><span class="si">{</span><span class="n">original_std</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sampled Dataset:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">sampled_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, Standard Deviation: </span><span class="si">{</span><span class="n">sampled_std</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Discuss insights from the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Insights:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- The mean and standard deviation of the sampled dataset may vary from the original dataset, indicating potential differences in alcohol content distribution.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Variability in sample statistics can influence decisions in data analysis and modeling, highlighting the importance of sample representativeness.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Dataset:
Mean: 13.00, Standard Deviation: 0.81

Sampled Dataset:
Mean: 13.01, Standard Deviation: 0.80

Insights:
- The mean and standard deviation of the sampled dataset may vary from the original dataset, indicating potential differences in alcohol content distribution.
- Variability in sample statistics can influence decisions in data analysis and modeling, highlighting the importance of sample representativeness.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Data-Reshaping-with-Pandas.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Reshaping with Pandas</p>
      </div>
    </a>
    <a class="right-next"
       href="Rose_Curve.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to Monte Carlo Simulation for Estimating Area Inside Rose Petals</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-actuarial-data-collection"><span style="color: dimgray;"><strong>Exploring Actuarial Data Collection</strong></span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strategies-for-collecting-data"><span style="color: dimgray;"><strong>Strategies for Collecting Data</strong></span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-probability-methods"><span style="color: dimgray;"><strong>Non-Probability Methods</strong></span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#probability-methods"><span style="color: dimgray;"><strong>Probability Methods</strong></span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerations-in-data-collection"><span style="color: dimgray;"><strong>Considerations in Data Collection</strong></span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-methods">Monte Carlo methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connection-to-sampling-methods">Connection to Sampling Methods</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-simulation-for-drawing-samples-from-a-standard-normal-distribution">Monte Carlo Simulation for Drawing Samples from a Standard Normal Distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-monte-carlo-methods-an-example">Using Monte Carlo Methods: An Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-explanation">Problem Explanation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#python-code">Python Code</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-methods-in-python"><span style="color: dimgray;"><strong>Sampling Methods in Python</strong></span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sampling-in-python"><span style="color: dimgray;"><strong>Simple Random Sampling in Python</strong></span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-s-random-choice">NumPy’s <code class="docutils literal notranslate"><span class="pre">random.choice()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-sample-for-sampling-without-replacement">Pandas <code class="docutils literal notranslate"><span class="pre">.sample()</span></code> for Sampling Without Replacement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-generate-a-large-population">Step 1: Generate a large population</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-draw-a-sample-using-simple-random-sampling">Step 2: Draw a sample using simple random sampling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-compare-histograms-of-population-and-sample">Step 3: Compare histograms of population and sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-perform-basic-statistical-checks">Step 4: Perform basic statistical checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-optionally-conduct-a-t-test">Step 5: Optionally, conduct a t-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-t-test-results">Interpretation of t-test results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary"><strong>Summary</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratified-sampling-in-r"><span style="color: dimgray;"><strong>Stratified Sampling in R</strong></span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#balanced-and-imbalanced-dataset"><span style="color: dimgray;"><strong>Balanced and Imbalanced Dataset</strong></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-random-sampling-srs-in-python">Simple Random Sampling (SRS) in Python:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stratified-sampling-in-python">Stratified Sampling in Python:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-1-simple-random-sampling-from-a-dataset"><strong>Answer to Question 1: Simple Random Sampling from a Dataset</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#answer-to-question-2-evaluation-of-simple-random-sampling-srs"><strong>Answer to Question 2: Evaluation of Simple Random Sampling (SRS)</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>